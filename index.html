<script>
    // Önbelleğe takılmaması için sonuna rastgele sayı ekledik
    fetch('kanallar.json?v=' + Math.random())
        .then(res => {
            if(!res.ok) throw new Error("JSON bulunamadı");
            return res.json();
        })
        .then(data => {
            const liste = document.getElementById('kanal-liste');
            liste.innerHTML = ""; 
            data.forEach(k => {
                // Sadece geçerli linki olan kanalları göster
                if(k.url && k.url.includes("http")) {
                    liste.innerHTML += `
                        <div class="col-4 col-md-2" onclick="playVideo('${k.url}', '${k.ref}')">
                            <div class="card channel-card p-2 text-center">
                                <img src="${k.logo}" class="logo-img mb-2" onerror="this.src='https://via.placeholder.com/60?text=TV'">
                                <small style="font-size:10px">${k.ad}</small>
                            </div>
                        </div>`;
                }
            });
        }).catch(err => {
            document.getElementById('kanal-liste').innerHTML = "<p class='text-center'>Veriler henüz işleniyor, lütfen 5 dk sonra tekrar deneyin...</p>";
        });

    function playVideo(url, ref) {
        alert("Kanal Linki: " + url);
    }
</script>
